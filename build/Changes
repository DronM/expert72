1.0.44
1) Ответственные лица, косяк к установке расчетпроцнта=true при открытии из диалога контрагента

2) Перешел на коды папок вместо наименований Application_Controller->removeFile,Application_Controller->download_file,Application_Controller->zip_all
все исправлено на коды. Максимум в константе 200 имволов
FileUploader_View.js
file_upload.php

3) Сортировка файлов при формировании PDF
get_print запрос к таблице application_document_files исправленасортировка с file_path на document_id

4) Не скачивал файлы из контракта
FileUploaderContract_View исправлено options.allowFileDownload = true;

1.0.45
1)ContractDialog Главный эксперт убрал disabled

2) BaseView.xslt cmd по умолчанию всегда=edit, даже если параметр не задан явно

3) ExpertWork_Controller поля date_time expert_id сели не админ и не главный эксперт всегда значения по-умолчанию

4)EditDate кнопка очистки значения disabled если контрол disabled

5)Фокусирование фрмы редактирования грида

6)doc_flow_out_processes_chain

7)DocFlowApprovement список виден только автору или дному из согласующих.
Перекрыта функция DocFlowApprovement_Controller->get_list

8)Вложенные разделы для экспертов

9)вкладка эксперта по умолчанию не отркывалась

10)actb закрытие автоподстановок при уничтжении контрола edit

1.0.47
1) Правильные условия в списке контрактов
2) Длина пароля в 20 символов - исправлено
3) Расчет даты выдачи заключения исправлен косяк
4) Новые поля для достоверности: входящая сметная стоимость, рекоменд.входящая сметная стоимость...
5) Косяк в BtnEndDate неверные поля в описании модели, функция расчета не работала
6) Убрал Uncaught Error: при генерации ошибки
7) Переодическое сохранение формы заявления
8) Убрал note после сохранения заяваления

1.0.48
1) Заголовок Access-Alow-Origin в локальном index.php
2) Application_View.js автосохранение обернуто во try-catch
3) FieUploader_View косяк в maxFileSizeErrorCallback Ошибка $h undefined у пользователя
4) Ошибка при загрузке -УЛ пробел в имени перед расширением
5) Кастомный сервер для upload ServerVariable custom_app_upload_server берется из настройки CUSTOM_APP_UPLOAD_SERVER из файла Config.php
если есть такая настройка. FileUploader_View добавлен параметр конструктора customUploadServer FileUploaderApplication_View этот
параметр устанавливает в зн-ие серверной переменной custom_app_upload_server

6)Таблица contacts, поля email post сделал типом Text, а то не помещалось длинное значение

7) Кнопка поиск контрагентов по ЕГРЮЛ добавлен title и файл локали

1.0.49
1) Автозапись заявления только у пользователя с правами "клиент"
2) Автозапись убрал

1.0.50
1) Убрал косяк при добавлении вместе одписи и файла, иногда подпись пиходила без doc_id

1.0.51
1) Контракт стоимость экспертных работ не записывалась
2) Распорядительный акт добавил количество символов, поле базы уже было текст
3) Новое поле список экспертов, подписавших заключение
4) Список аккаунтов добавлено поле дата создания
5) Убрал лишний слэш в навигации
6) Переделана работа с возвратом заявления на корректировку, добавлена кнопка для смены статуса заявления (разрешение на редактирование)
7) Проверка дней при расчете дат
8) contracts_work_end_date Прибавил 1 день к рабочим
9) Список контрактов не переходит по страницам у всех кроме админа - исправлено
10) Исходящее письмо клиента при заявлении стоял неверный тип: ответы на замечания - исправлено
11) Запоминает состояние боковой панели между сенсами

1.0.52
1) Удаление из таблицы экспертов, подписавших контракт
2) Генерация меню из временных файлов, а не из моделей. Нужно для более простой установки обновлений
3) Выход через скрипт, чтобы  не было косяков после нажатия выход
4) Убрал из комманд таблиц "все колонки"
5) Добавлен корр/счет банка в представление банка
6) Неверный подсчет id в списке шаблонов деревьев, из-за этого были косяки с подчиненными узлами документации
7) Изменил форму адреса как в ФНС
8) ошибка, если нет ни одного вложения. PDF без папок не формируется, ошибка pdf переходит на клиента

1.0.53
1) Убрал warning из лога
2) Исправл чтение моделей меню
3) Непосредственное удаление файлов у неотправленных на проверку заявлений
4) Отправка по несколько раз

1.0.54
Сходу исправил косяк, доступ на кнопку отправить если ошибка

1.0.55 04/07/18
1) PDF анкета учет удаленного сервера
2) Контроль версий клиента и сервера
3) Запись форм заказчика в синхронном режиме и блокировкой окна и показом прогрессора. Заявление, вход.письмо клиента, Исх.письмо клиента
4) заменил pace на свой	 globalWait 

1.0.56 04/07/18
1) Срочно исправлен косяк в window.setGlobalWait



1.0.57 05/07/18
1) Согласования: не пересчитывает шаг при удалении
2) Не показывало дату до когда отправлено на корректировку
3) Убрал возможность отправки исх.писем с неправильным статусом
4) Файлы в статусе заполнения/исправления заявлений не удалялись непосредственно, все же был косяк


1.0.58 06/07/18
1) Установка просмотренных сообщений теперь асинхронная

1.0.59 06/07/18
1) Скачка сига нашего у подписанных заялвлений
2) Косяк в форме заявления у начальника отдела


1.0.60 07/07/18
1) Morpher неправильно был указан insert запрос на readonly server
2) Чуть подкорректил форму заявления: не печатал род и дат. падежи
3) Переделал common/file_func.php рекурсивное копирование, удаление



1.0.63
1) Чат допилил
2) Рапорядительный акт расширил до 1000 знаков
3) Недоступные поля доступны для копирования/фокуса
4) Отправка без заявления при прикреплении заявлений перд отправкой
5) все статусы может удалять админ у любых заявлений
6) После исключения при записи кнопки не становятся enabled
7) При отправке заявления на корректировку - письмо клиенту на мыло

1.0.64 13/07
1) Скачка исх.документов с другого сервера
2) Новый тип мыла - возврат контракта, исправлены письма при возврате
3) Функция Присвоения нового номера исх.письма исправлено на мастер сервер
4) Обработка ошибок кнопки ОК
5) ValidatorEnum неправильно проверял значения null
6) editRadio disabled а не readOnly


1.0.66 18/07
1) Серверная проверка на наличие файлов с заяалениями и наличие файлов документации
2) Клиентская проверка перед отправкой
3) В контракте представление клиента: наименование+инн+огрн
4) Формы диалога электронной почты
5) Уведомление главному отделу экспертизы при изменении в таблице экспертов
6) Галочка "Доступен всем сотрудникам" в диалоге контракта доступа для редактирования только админу
7) Запись процента заполнения происходила не всегда
8) Происходила всегда запись пустых полей печатных форм
9) IE10 открытие, закрытие окна, Правильная обработка EditRadio
10) Закрузка множества файлов при возврате контракта
11) Разделение заявки при подаче заяваления Экспертиза+Достоверность не учитывало двух серверов
12) Входящее письмо наше отображение вложений
13) Произвольные вложения в исход.клиента с типом ответы на замечания
14) Создание архива: учет отсутствия папки с заявлением на клиентском сервере



1.0.67 19/07
1) Исход.письмо наше не скачивались файлы - поправил наживую
2) Форма диалога Исход.письма лишние кнопки при отправленном документе
3) папки по-умолчанию при отправке писем
4) Работа экспртов: учет двух серверов
5) Отчеты: реестр по экспертизе, достоверности


1.0.69
1) Ошибки в реестре, выписке
2) новый тип исходящего письма - договорыне документы



1.0.70 26/07
1) Согласование: не согласовано, не закрывалось сразу, неправильно отражало статус в форме диалога (показывало шаг)
2) Дотсупность для редактирования контрола "Тип проверки ПД" в диалоге контракта при достоверности
3) Удаление зип файла при любом НАШЕМ исходящем письме (вдруг контракт?!)
4) Добавить кнопку Архив в диалог контракта. Доступ только отделу приема
5) Наш Исходящий документ на согласовании, конпка регистрация доступна - запретить. Модуль регистрации: проверка статуса исх.документа. Отказ
при неверном статусе.
6) Дата и номер пп в счет-фактуру при выписке акта


1.0.71 03/08
1) Проверка сертификатов ЭЦП при загрузке, сохранение результата в БД для отчета
2) Отчет о проверки ЭЦП, кнопка в заявлении для отдела приема и администратора
3) Выбор расчетного счета при создании счета из программы
4) Сокращенное имя автора в списках во всех документах,сокарщенное ФИО гл.эксперта в контрактах
5) Список регистраций колонка автор
6) Ошибка в исх.письме нашем: тип договорные документы, папка не была видна.
7) Согласование: при любом результате (согласовани/не согласовано) если закрыто, то доступ закрыт. Второй раз отправлять запрещено!!! Проверел
8) Контракт: при нажатии ОК срабатывает как отмена. Вопрос: сохранить?
9) Распорядительный акт: текст, 3000 знаков
10) Документ контракт: новые поля первичное заявление, номер первичного заявления
11) Рег.номер первичного контракта доступно для изменения в контракте
12) Перемещение файлов в другие папки после отправки исх.письма. Доступно администратору
13) В тему исх.письма добавлено название объекта во всех типах исх.писем. Соответственно объект переходит и в Согласование
14) Клиенту в исх.письме в прочих файлах можно крепить только 4 файла (2 с подписями)


1.0.72 07/08
1) Ошибки PKIManager.php: пути к файлам с пробелами
2) pki.php ошибка при insert escape error_str
3) Application_Controller отчет по ЭЦП, неверный путь к файлам если файлы проверяются при построении отчета
4) Отправка договорных документов клиентом, проверка ЭЦП "на лету"
5) При отправке заявителем письма "Возврат контракта" не удалялся кэш архива, архив после этого возвращался устаревший (без возврата контракта)
6) Согласования доступны на чужом шаге - исправлено
7) Полный доступ админу к документу "согласование": любые изменения,шаги,результаты и т.д.
8) Доступ админу на редактирование задач: закрытие


1.0.73 03/09/18
1) Проверка на доверенность: теперь проверяется не поле "Наименование", а поле "Полное наименование" для того,
чтобы правильно проверялись контрагенты с типом "ИП" и "ФизЛицо"
2) Входящие документы: контракт ЗАМЕНИТЬ contracts_dialog, doc_flow_in_list
3) Ошибка формирование PDF если заявитель, заказчие,застройщик ПБОЮЛ или физлицо
7) Проверить -УЛ на пробелы!!! Все верно, можно в любом регистре, с пробелами между/после тире
8) ИНН у ИП слишкои длинное значение - исправлена ошибка
9) Ограничение на вход: проверка версии IE8 - не работает
10) Согласование можно редактировать даже если закрыто  для админа!
11) Редактирование (замена) файлов отправленных(!) писем для админа
12) Шаблоны в IE9,IE10 function.name не работает, обход
13) Сбор статистики какими сертификатами подписывает пользователь. При проверке подписи в бд записывается отпечаток сертификата.
В дальнейшем возможна авторизация по данному сертификату.
14) Формирование ЭЦП по заявлениям в ЛК:
15) Отчеты: реестр заключений ПД,достоверность - фильтр по результату
16) Список экспертов для уведомления по ответам на замечания. Обновление автоматом при добавлении работ. Ручное редактирование.
17) Формирование договора в 1с: дата Контракта. Исправлено наименование улсуги, стояла дата создания документа, а не дата контракта.


1.0.74 02/10/18
Поставил на тестирование

1.0.75 03/10/18
Добил отчеты:
Реестр контрактов (выборка),
реестр оплат
Везде заголовки, фильтры и т.д.

1.0.76 03/10/18
Орфографическая ошибка в VersException

1.0.77 04/10/18
1) Загрузка файлов дркументации исправлен путь код раздела на имя
2) EditNum
3) Квартальный отчет

1.0.78 05/10
На проверку

1.0.79 08/10
1) Проверка нескольких подписей в контейнере
2) Квартальный отчет: добавлена достоверность


1.0.80 09/10
Косяк в диалоге контрактов


1.0.82 10/10
Форма диалога согласования: когда пустой сотрудник - ошибка
Детали подписи в Входящем письме клиента
Ошибка формирования PDF
http://92.255.164.139/index.php?c=Application_Controller&f=get_print&v=ViewPDF&id=2181&inline=1&templ=Application
Ответы на замечания: удаление файла невозможно пока документ не записан
PKIManager: неправильное вычисление fingerprint при разборе подписи,как результат пустая дата подписания

1.0.83 11/10
Платформа: Field.php, cmd.php убрать дублирование в htmlspecialchars

Поле расчетный счет в заявлении (EditBankAcc) убрал шаблон, сделал наследование от EditNum для возможности копирования номер р/с

статус Заявления "Передано в архив". Ставится при возврате документов, при текущем статусе "Выдано заключение". После этого письма отправлять нельзя,
ничего нельзя
doc_flow_out_client_process()

Дата на хостинге: Московское время, sudo dpkg-reconfigure tzdata

Косяк при удалении подписи при нескольких подписях
Удаление файла из нашего письма

Исходящее письмо клиента ответы на замечания.
	Кнопка "Заменить" доступна даже у незагруженных файлов.
	Запрет на любое письмо при статусе заявления "в архиве"
	Запрет на все письма кроме "Возврат подписанных док-ов" при статусе заявления "выдано заключение"

При загрузке в Хроме при попытке скачать файл иногда сначала выдавалась ошибка, но файл скачивался


1.0.84 14/10/18
PKIManager:
	Константа для проверки подписей PKI_MEMORY_LIMIT
	Заголовок сертификата для определения кодировки


Отправка письма клиентом: При ошибке не показывала ошибку

Новый тип исходящего письма клиента - Отзыв контракта/заключения

Удаление одного из исполнителей

Заявление Заполнение исполнителя по...

doc_flow_out_client_dialog
doc_flow_out_client_files_for_signing
doc_flow_out_client_process

DROP TRIGGER doc_flow_out_client_before_trigger ON doc_flow_out_client;
CREATE TRIGGER doc_flow_out_client_before_trigger
BEFORE DELETE OR INSERT OR UPDATE
ON doc_flow_out_client
FOR EACH ROW
EXECUTE PROCEDURE doc_flow_out_client_process();


1.0.85 20/10/18
0) Исправлен косяк: неверное имя файла при загрузке документации - имя подписи вместе с sig!!!
1) Исходящее письмо клиента не спрашивает о незагруженных файлах
2) Подписание нескольких файлов, единый прогрессор
3) Кнопка "Подписать все"
4) Редактирование для админа отправленных писем - можно все: удалять добавлять
5) Исходящее письмо клиента при возврате документов: при открытии сохраненного виден ключ. После подписания виден ключ(?)
6) Письмо при ответах на замечания: какие разделы изменены


1.0.86 28/10/18
0)Восстановление удаленных файлов при удалении неотправленного письма клиента
1)Повторная подпись, котороль по СНИЛС на клиенте и на сервере
2)Подписание в Yandex,OPERA,IE10 проверено
3)Удаление подписи, когда их было несколько в файле
4) Запрет на создание новых исходящих клиента, если уже есть такой же документ с таким же типом по заявлению
doc_flow_out_client_list
5)Информация по обновлению плагина
wget -O crypto_plugin.txt https://www.cryptopro.ru/sites/default/files/products/cades/latest_2_0.txt
6)Нормальная проверка подписей со всей цепью
7)ГУИ при ошибках загрузки (данные,подпись),ошибки проверки ЭЦП


1.0.87 
1) Отображение сертификатов даже для ошибочных подписей
2) PKIManager работа с CRL
3) FileUploader_View.js 1782, pic empty??


1.0.88 31/10 поставил только js
1) Непонятные ошибка в гуи setFileUploaded
2) Исправлены ошибки гуи при подписании всех файлов одновременно


1.0.89 05/11
2) User_Controller ошибка при подтверждении мыла, описка в имени таблицы
3) mv вместо rename при загрузке подписи
4) Ошибка с синхронном AcdesAPI неправильный прогрессое приподписании
5) Правильное удаление в нашем исх.письме. со всех серверов
6) При добавлении новой подписи через файл отображалась инфа из первой, переделал на последнюю
7) Неотправленный документ клиента, при открытии показывает ключики для подписи
8) ГУИ подписание - кнопка "удаление файла", кнопка "загрузить все", "подписать все" - недоступны
9) IE ошибка проверка цепи сертификатов
10) IE не открывалось окно фильтра, "Все команды"
11) Порядок следования подписей в исх.письме клиента doc_flow_out_client_files_for_signing


1.0.91 16/10
Тестирование мультимастеров

1.0.92 24/10
1) Подписание ответов в IE
2) IE10 hierarchyRequestError
3) Вроде нет проблем в IE10 с открытием окон, с заполнением параметров
4) Профиль изменение "Дублировать напоминания на электронную почту" не открывало кнопку "сохранить", тоже и настройки плагина
5) дополнительные таблицы для подписей для возможности работы с двух мастеров
6) Добавление исполнителя, позийионирование (скролл), фокус на наименование
7) Заполнение клиентов, теперь окно не скачет вверх
8) Неквалифицированные сертификаты
9) Невозможно отозвать отправленное заявление, ошибка - заявление отправлено на проверку!

1.0.93 26/10
1) Удаление файла доверенности

1.0.94 27/10
1) PKI_OPENSSL_PATH OpenSSL library directory для поддержки нескольких библиотек, для ГОСт2012
2) Подписание внутреннего документа в браузере не работало
3) Константа PKI_MODE из файла file_upload в Config.php
4) Ошибка при добавлении доверенности в заявление при insert (не update!) - двойная кавычка в подписанте не проходит!
5) openssl 1.1.1 для работы с GOST2012
7) Входящие клиента, показано заявление в таблице
8) Входящие клиента, отбор не нажимаются кнопки
9) Шаблон заявления, width=100 у таблиц для удаления предупреждения

1.0.95 01/12
1) FOP warning width в шаблоне
2) Константа в настройках PKI_LOG_PATH
3) Новые предопределенные типы вхрдящих писем: продление срока и отзыв.
4) Форма документа "Контракт", кнопка архив была доступна только admin и юристы - исправлено
5) Предусмотрен перенос из исходящих писем клиентов во входящие наши для типов: возврат продление срока


1.0.96 05/12
1) Не записывались пустые даты при изменении форм
2) При мердже подписей убрал проверку цепи получившигося файла (отозванность,просроченность), в остальных случаях работает PKI_NO_CHAIN_VERIFICATIONнастройка 
3) Заявление новое поле update_dt - для отражения последней даты изменения заявления
4) Излишняя запись пустого поля modif_primary_application_id при нажатии "запись" заявления
5) Контроль указания в кач-ве первичного само заявление
6) Удаление статусов контракта - округление до секунд, таблица _lk
7) Контроль при отправке письма клиента со статусом "Возврат подписанных док-ов". Как минимум один документ должен быть подписан.

applications_trigger.sql
applications_process.sql

1.0.98 12/12
1) Формирование ZIP из нашего входящего письма
2) Формирование ZIP из заявления


1.0.99 15/12/18
1) Отправка почты: новая стратегия отправки, колонка ошибка (отражает ошибку с сервера при отправке).отправка только на подтвержденные адреса
* EmailSender.php,ExpertEmailSender.php
* Дополнительные данные в константе outmail_data вместо Config.php
* При регистрации письмо о новом аккаунте содержит ссылку для подтверждения адреса почты (User_Controller.php->register())
* Отправка только на подтвержденные адреса: reminders_process(),doc_flow_in_client_process()
* users_before_update обнуление email_confirmed при смене адреса
* view EmailConfirm.html
2) Правильная ссылка при подтверждении мыла пользователя v=EmailConfirm
3) Убрал проверку цепи при удалении подписей в наших исходящих (DocFlow_Controller) и клиента (DocFlowOutClient_Controller) при вызове pki_log_sig_check()
4) Реестр оплат экспеорт в Ексель, поля даты
5) Серверный шаблон ModelToExcel.xls.xsl


1.0.100 22/12/18
1) User_Controller->email_confirm($pm) не обновляло переменную сессии user_email_confirmed, из-за этого не было отметки о подтверждении в тек.сессии
2) User_Controller->email_confirm($pm) ссылка действовала не 24 часа, а в передлах тек.даты - исправлено
3) Шаблон сведения об исполнителе (ApplicationContractor.html) убрал индекс исполнителя.
4) Шаблон сложного объекта CompoundObjTechFeature убрал индекс исполнителя.
5) исправлен общий класс BaseContainer.js для правильной обработки индексов
6) Система справки
7) Шаблон ексель квартального отчета

1.0.101 07/01/19
1) Новая схема: нет достоверности, модификации
2) Переход к началу таблицы при выборе страницы пагенации


1.0.102 14/01/19
1) Поиск по автору документа: согласования, внутренние, рассмотрения,регистрации
2) ЛК: выделение цветом непрочитанных писем
3) Исходящие письма: колонка содержание
4) Уведомления на почту о событиях: окончание срока экспертных работ, окончание срока выдачи заключения
5) Тема вход. письма при ответах на замечания=+Регистрационный номер
6) При установке задачи добавлен номер контракта "Согласовать , контракт №..."
7) При копировании заявления поле "cost_eval_validity" переходит в новое поле "exp_cost_eval_validity"

1.0.103 16/01
1) При установке галски "Гос.экспертиза" в заявлении, сразу включается ПД
2) Серверная проверка при отправке только нового поля "достоверность"
3) Контракт: продление срока: новая таблица, триггеры, форма диалога контракта
4) Открытие старых документов
5) Косяки в таблице ответственных лиц, ввод пустой строки
6) Отправка писем возврат документов, только доп. вложения, разрешить если нет док-ов для подписания
7) Отправка предупреждений об окончании срока и ответственным экспертам тоже (если почта подтверждена)
-8) Сслылка для скаичвания и наименование файла при входящем письме "ответы на замечания" экспертам

1.0.104 17/01
1) Обратно только старый порядок!
2) doc_flow_out_client_process Во входящем нашем пиьсе ссылки на добавленные файлы


1.0.105 28/01
1) Новая константа - список экспертов с доступной закладкой "Документы" в Форме диалога контракта. Изменена форма диалога конгтракта


1.0.106 28/01
1) Видна таблица изменения сроков у экспертов

1.0.107 12/02/19 
1) Не видна таблица "Документы" у определенных экспертов
2) Хэширование при создании ЭЦП в зависимости от сертификата CadesAPI,CadesAPI_async

1.0.108 01/06/19
1) ExpertiseProlongationList_View minor glitch
2) Новая роль expert_ext,Contract_Controller
3) applications_dialog.sql
4) contracts_dialog.sql,contracts_list.sql
5) Модуль Application_Controller->get_object()
6) Модуль Contract_Controller->get_object()
7) Модуль Contract_Controller->get_list()
8) doc_flow_in_dialog
9) doc_flow_out_client_dialog queru 9sec
10) doc_flow_in_client_dialog
11) doc_flow_out_dialog
12) doc_flow_inside_dialog

Заявления - 7сек - 3 сек
Контракты - 12сек - 5 сек
Наши Вход.письма - 5сек - 2 сек
Исх.письма у клиента запрос - 9 сек - 58милсек
Вход.письма у клиента запрос - 10 сек - 13милсек
Наше исходящее - 5 сек - 3 сек
Внутренние окрытие формы 5 сек - 
1.0.109


1.0.109 03/06/19
1) Небольшой косяк при выводе сообщений WindowMessage.show() параметр text может быть объектом

1.0.110 03/06/19
1) Косяк в валидации дат


1.0.111 09/10/19
1) новая колонка заявления fund_total, новое поле формы диалога 
2) Копирование руководителя в отв.лица
3) Редактирование локального набора данных переписал Model.js,ControllerObjClient.update,Grid.ModelToCurrentRow
4) message_window_style, настройка в профиле. Поддержка на уровне платформы двух типов окон сообщения: поверх и рядом
5) Поменял ТОЛЬКО mkdir_or_error в file_upload.php
6) db/SessManager.php оставить из старой платформы


1.0.113 10/10/19
1) Исходящее письмо наше: все разделы отмечены по-умолчанию для изменения DocFlowOutDialog_View.prototype.fillSections
2) Скрыть вкладку с разделами
3) При ответах на замечания ВСЕГДА требовать сопроводительное письмо

1.0.114 13/11/19
1) При удалении документации в исх.письме клиента - удалять его ИУЛ, При Замене - тоже самое!
2) Проверить добавление (замену) файлов документации, НЕСКОЛЬКО операций подрят

1.0.115 13/11/19
1) Косяк у экспертов при открытии исх.письма - видны разрешения!

1.0.116
1) Новое поле в контрактах allow_new_file_add если установлено админом - всегда разрешать добавление файлов
doc_flow_out_client_out_attrs
В ГУИ у админа отметить контракты с разрешениями

2) Отметка новых загруженных файлов в исх.письмо клиента, в нашем входящем письме doc_flow_in_dialog, в контракте на вкладке документация
3) При отправке документации ПД+РИИ+Достоверность, при отщиплении делает новое завление с expertise_type=pd_eng_survey, а надо NULL
applications_split Перепровел?



1.0.117 20/01/20
1) Новый порядок подачи заявлний: Достоверность включена в Гос экспертизу:
	applications_list
	application_processes_process()
	applications_dialog		
	applications_dialog_lk
ApplicationDialog_View.js
ApplicationServiceCont.js
DocumentDialog_View.js
Application_Controller.php
Шаблоны печ.форм
Заявление Достоверность без ПД 36
select * from applications_dialog where application_state='filling' and cost_eval_validity AND expertise_type is null order by create_dt desc limit 50


1.0.118
1) ContractDialog_View расширил вид экспертизы, поправил шаблон ContractDialog.html
2) Не открывает список банков: поле наименование слишком длинное
3) После нажатия кнопки Копировать руководителя в отв.лица не пересчитывается процент ClientResponsableGrid.js
4) не показывает файлы в старых заявлениях по достоверности  DocumentDialog_View.prototype.toggleDocTypeVis два раза устанавливает видимость вкладки
	cost_eval_validity

1.0.119 - 1.0.124
1) Оставил отладочный косяк!!!

1.0.126 11/02/2020
1) сделать отметку об удалении!!! поставить дату когда и больше не трогать!!!
Добавить таблицу хранения удаленных
regl_docum_deletion.php
Таблица добавлено в ГУИ

2) Доступность доверенности ApplicationClientEdit.setAuthLetterRequired переделано. Также предупреждения при смене данных

3) Пункт 4 задания от 13/01/20
contracts allow_client_out_documents
Константа const_ban_client_responses_day_cnt_val() = 
DocFlowOutClient_Controller->check_resp_doc

4) Пункт 9 задания
При поступлении входящего письма с типом "Возврат контракта", если при этом сумма финансирования бюджет
contracts.expertise_cost_budget>0 тогда надо менять статус, все как при поступлении оплаты
Изменена функция sql client_payments_process() чтобы учесть возможную пост оплату
Внесены изменения в sql функцию doc_flow_out_client_process() для установки статуса "экспертиза", а не ожидание оплаты как раньше


5) ext/CadesAPI.js при успешной загрузке плагина не note а tempNote

6) Добавлены поля:applications.customer_auth_letter,customer_auth_letter_file
Внесены изменения в
ApplicationDialog_View.js
Application_Controller.php
ApplicationClientEdit.js
Шаблоны:
Application.xsl.docx
Application.pdf.xsl
ContractDialog.html Техн.заказчик после застройщика
contracts_dialog.sql


7) Появились письма отклиента, где указано, что изменены определенные разделы, а по факту таких файлов нет, есть в другом письме
т.е. есть данные в doc_flow_out_client_document_files а в application_document_files таких файлов нет!!! в итоге отображаются пустые строки во
входящем нашем письме, и в измененных разделах тоже. Изменил
doc_flow_in_dialog.sql
doc_flow_out_client_process.sql
добавил условие app_f.file_id IS NOT NULL


8) Заявление/Контракт , в документации Контракта иногда есть пустые файлы(?)
Contract_Controller.php поменял на вызов Application_Controller::attachmentsQuery, был свой вызов, хотя потом обработка такой же функцией
Application_Controller::addDocumentFiles

9) При копировании старого: определить что Техн.Заказчик=застройщикщик и поставить галочку!!!

10) cmsmerge теперь берется из PKI_DIR + bin !!! УЧЕСТЬ ПРИ УСТАНОВКЕ!!!
PKIManager.php

11) При исключении во время вкладывания (merge) подписи ГУИ не возвращает обратно ключик для повторного подписания
FileUploader_View.prototype.uploadSigFile
исправлено

12) Ошибка во время подписи

Надо:
!!!При отправке заказчиком ответов в воскресенье или субботу ставит ответы на вторник?!	
select doc_flow_out_client_out_attrs(3029)	

!!!doc_flow_out_client_document_files удалять файл, когда удалили НАШЕ входящее письмо, а исход.клиента стало неотправленным!!!

-При удалении регистрации, письмо клиента (входящее удаляется, а файлы application_document_files нет)




1.0.127 12/02/2020
1) Переименована доверенность технического исполнителя
2) Функция исполнителя - по умолчанию не стоит

1.0.128 12/02/2020
1) ApplicationDialog поле sent_dt для правильного пересчета от 11/02/20
ApplicationClientEdit.m_custIsDevText
ApplicationDialog_View.onGetData

1.0.129 13/02/2020 поставил клиенту
1) Форма диалога контракта: не показывались доп.поля по достоверности в новых контрактах (после 17/01/20) ContractDialog_View
2) Application_Controller->all_sig_report ошибка нет добавочного параметра $db_app_id в строке запроса- в рез-те запрос пустой!
3) ApplicationDialog_View поменял вариант показа нового порядка от даты подачи а не даты редактирования

1.0.130 14/02/2020
1) Не открывает гиперссылку если открывается объект того же вида: из контракта открыть форму другого контракта. Причина: имя окна было
равно виду объекта, соответственно всегда одно и то же (ContractDialog), переделал функцию открытия ссылки гиперссылок
ссылочных типов GridColumnRef.js (click), а также открытие объектов Grid.js функция initEditWinObj

1.0.131
1) Новое перечисление "Тип услуги"
	Справочник виды услуг добавлена ссылка на виду услуги. Теперь нет необходимости работать с предопределенными элементами, брать 
услугу по виду сулуги
	Переделать отсылку заявления, убрать зависомость от предопределенных 
элементов
Форма диалога заявления: добавлено поле вид услуги, через него идет привязка к ГУИ вид услуги, а не через спец поля,
типа audit,modifcation,cost_eval_validity и т.д.

app_print_audit,app_print_modification,app_print_expertise все переходит в одно поле app_print с единой обработкой
app_print_cost_eval остается для старых заявлений по Достоверности, когда услуга не входила в Экспертизу


2) PKIManager обновление списка сертификатов, очистка списка перед копированием
Переделан алгоритм makeCACertificates

3) DocFlowOutClient новое поле повторная отправка, для возможности отправить без создания всей цепочки, чтобы
можно было откатить назад, довложить файлы и т.д.
Возможность сделать неотправленным для админа
doc_flow_out_client_process()

4) Изменил PKIManager->build_chain, нашел ошибку: расширение файла сертификата может быть cer/crt, также теперь, если даже
не смогли определить серт, то выкачивается свежий список с Госуслуг и ищется этот сертификат. Долго, но надежно


5) merge.c проверка если уже есть сертификат!!!

6) file_upload.php была ошибка при мердже: если уже есть подписант, то ошибки не возникало, из-за проверки по subject->SNILS не было проверки 
по subject->СНИЛС - исправлено. Также добавлена проверка по fingerprint. Т.е. если уже есть серт с таким fingerprint - не даст добавить

7) Ошибка при открытии письма исходящего клиентом: всегда пишет, что уже есть письмо такое неотправленное,
исправлено DocFlowOutClient->check_unsent_doc NOT %d



1.0.132 08/04
1) Квартальный отчет, добавлен фильтр в ГУИ, исправлен шаблон, шаблон excel, Contract_Controller


1.0.133 09/04
1) Фильтр таблиц: при удалеии остается GridSearchInf.js ид фильтра, при повторной фильтрации по той же колонке - удалять!
2) Модель DocFlowTaskShortList_Model ограничение 100 строк!


1.0.134
1) Косяк из-за незагрушения основного объекта при открытии какого-то конкретного юрла, а потом хождения по меню, например отерыли
http://expertiza72.ru/c=DocFlowApprovement_Controller&t=DocFlowApprovementList_View...
а потом перешли в меню на другой объект, первый остался жить!!!
	ViewBase.html.xsl function showView() - создание объекта не в переменную а в window['page_views']
	App.prototype.renderContentXML разрушает window['page_views'] 


1.0.135 15/04
1) Реестр контрактов, нет всего списка услуг


1.0.136 18/05
document_templates_all_list_for_date
1) При разрешении редактирования заявления не дает исправить файл доверенности
	Проверил - все разрешает
Изменить applications_get_documents для учета expertise_type
Изменить ApplicationDialog_View для определения вкладок


2)FileUploaderDocFlowIn_View учет удаленных файлов,
doc_flow_in_dialog.sql


1.0.138 27/07/20
Исправлен реестр: добавлен фильтр по дате начала



1.0.139 07/08/20
1) Вкладка экспертиза у контрактов по измененной документации якобы пустая? Пустая.
при создании контракта в doc_flow_examinations_process() document_type оставался пустым. Сделал при путом expertise_type
утановку в pd. Непонятно когда cost_eval_validity? Видимо надо анализировать service_type=modified_documents
и как-то отдельно отрабатывать, брать из первичного?

2) При открытии изм. документации якобы ошибка.  При октрытии диалога контракта - ошибка expert_maintenance_expertise_type не найдено поле.
Добавил поле в модель.

3) Добавить раздел в контракт по экспертному сопровождению: Заключения по разделам. Вывести: номер,дата,файл+подпись заключения по разделам,
связанным с этим разделом.

4) Отчет реестр контрактов, фильтр по бюджет/не бюджет fund_sources
5) Экспорт в Ексель локальных таблиц по-новому



1.0.140 19/10/20
1) views/functions.xsl исправлена функция форматирования сумм для правильной выгрузки в Excel и функция форматирования дат
2) Внебрачные контракты
	Пользоватекль: поле, разрешающее использование внебрачных контрактов  allow_ext_contracts
	user_view.sql
	user_dialog.sql
	UserDialog_View.js
	User_Controller.php новый глобальный парамтер allow_ext_contracts
	ViewBase_php.xsl allow_ext_contracts
	таблица applications поле ext_contract bool default FALSE
	applications_list.sql ТОЛЬКО ext_contract=FALSE
	Модель ApplicationExtList, полная копия ApplicationList только показывающая ext_contract=TRUE
	Application_Controller new methods: get_ext_list,complete_ext
	Новый пункт меню (views) заявление (внеконтрактные)
	ApplicationExtList_View.js
MainMenuConstructor_Controller->update исправлен косяк при вызове функции без параметра	
	ApplicationDialog_View.js
	ApplicationDialog_html.xsl
	application_processes_process.sql
	doc_flow_out_client_process.sql
	doc_flow_in_process.sql
	Таблица doc_flow_in поле ext_contract заполняется из doc_flow_in_process.sql
	Новая константа ext_contract_doc_pref
	Новый параметр в функции doc_flow_in_next_num, вызывается из doc_flow_in_process. Теперь также передается контракт/внеконтракт
	doc_flow_in_list.sql Условие только контракт ext_contract=FALSE
	doc_flow_in_ext_list.sql
	views + внеконтракт
	applications_ref.sql
	Таблица doc_flow_out новое поле ext_contract
	doc_flow_out_dialog.sql
	doc_flow_examinations_dialog.sql
	DocFlowExamination_View.js
	DocFlowOutDialog_View.js, тема
	Application_Controller.php,Contract_Controller.php функция get_constr_name() теперь возвращант и признак внеконтракта
	tmpl/DocFlowOutDialog.html
	DocFlowOut_Controller->get_next_num() теперь принимает и признак внеконтракта для формирования номера
	Новый параметр в функции doc_flow_out_next_num, вызывается из doc_flow_in_process. Теперь также передается контракт/внеконтракт
	doc_flow_in_dialog.sql
	BtnNextContractNum.js
	DocFlowOut_Controller->get_next_contract_number() теперь принимает и признак внеконтракта для формирования номера
	contracts_next_number.sql
	doc_flow_out_list.sql Только контракт!
	doc_flow_out_ext_list.sql
	views Исходящие документы (внеконтракт)
	Новое представление для журнала исх.жлкументов внеконтракт DocFlowOutExtList_View.js
	contracts_list.sql Только контракты!
	views Контракты (внеконтракты)
	forms/ContractExtList_Form.js
	views/ContractExtList_View.js
	doc_flow_examinations_process.sql
	contracts_dialog.sql
	ContractDialog_View.js
	ContractDialog.html
	contracts_expertise_result_number.sql
	document_templates_list
ДОБИТЬ функцию contracts_ext_to_contract.sql
сталось:
	+Исходящие документы (список,поле, создание из списка с признаком или на форме)	
	+Создание контракта (свой список, префикс)
	+Копирование всех документов из внеконтракт ->> контракт
	+Убрать из меню у кого не надо
!!!vendor/cakephp/filesys/Folder line 580,curly braces

+Статусы заявления на доступ админу. Все формы статусы.
	Сделано ранне, проверил
+Копирование старой достоверности, не переходлит в новую услугу
	Application_Controller.php
+При создании заявления по достоверности, записали, открыли, появляется обязательное поле Повторное использование/неиспользование... и требует
его заполнения!!!
	ApplicationDialog_View.js
+Разные сроки блокировки отправки исх.писем по услугам.
поле ban_client_responses_day_cnt в services, ServiceList_View.js, DocFlowOutClient_Controller->check_resp_doc()

+Исходящее наше письмо, добавить возможность у папок, которые требуют подписания клиента, убирать галочку, или наоборот,
чтобы при вставке в таблицу application_document_files сразу ставилась галочка file_signed_by_client
Поле doc_flow_attachments.require_client_sig
doc_flow_out_dialog
doc_flow_in_client_dialog
doc_flow_out_client_files_for_signing
FileUploaderDocFlowOut_View.js->onFillTemplateOptions()


+Копирование документа, ИП, ФЛ ошибки отображения

+При продлении контракта начинает считать со дня окончания, а надо + 1 день,
Ипрсавлена функция ExpertiseProlongation->calc_date(), прибавлен день к дате конца работ по контракту

+Переименовал Сроки в списке услу. ServiceList_View.js

+Пустые уведомления. пустая тема в письме
	application_processes_process()
	doc_flow_out_client_process()
	
+Копирование внеконтрактов попадает в контракт

+Нумерация контракта при переводе во внеконтракт
-Непонятные заблокированные разделы в ответах


1.0.1342
1) Косяк: все исх. письма - внеконтракт
2) Меню XML Tree не отображает все строки!!!
3) Косяк с открытием сохраненной настройки


*************************************************
Исходящее письмо клиента при удалении: удалять в триггере файлы original_file_id и физически
все с ним связанное: вход.письмо наше, рассмотрение (если есть), статус заявления назад, если рассмотрение



Файлы на доступ админу

- Выбрали недействительный серт, он отметился красным, потом сменили на нормальный - все равно остался красным


ОООчень долгая инициализация часта???
- 1) FOP warnings Arial normal 700 есть Arial normal 700, INFO


file_verifications_lk_process()
file_signatures_lk_process()
user_certificates_lk_process()
applications_process()
client_payments_process()
contacts_process()
contracts_process()
doc_flow_approvement_templates_process()
doc_flow_approvements_process()
doc_flow_attachments_process()
doc_flow_examinations_process()
doc_flow_in_process()
doc_flow_in_client_process()
users_process()
doc_flow_registrations_process()
doc_flow_in_client_after_trigger
doc_flow_out_process()
application_processes_lk_process()
applications_list_lk
application_corrections_process()

- Авторизация ЕСИА

- Слобовидящие  ААА цветовая Схема Бел|Черн|Голубой|Лиловый|Зеленый|

-2 мастер сервера ??? непонятно надо или нет







//**********************************************************
МИНИМАЛЬНО ПОДДЕРЖИВАКМЫЙ IE - 10!!!
IE9 работает но верстка кривая, Пустые дочерние окна!!!
IE8 - закрыт доступ
ToDo

- Пришли подписанные документы: 2 сообщения. Эксперты жалуются, что получают по несколько сообщений. Проверить ссылку в рабочей программе.
- IE10 ошибки FatalException

+ Postgres replication SSL
+ Все на https
+ IE10 не работает кнопка Все фнкции и Фильтр в таблицах
+ Номер счета банка в заявлении ___ убрать!!!
+ Согласования добавить фильтр по статусу контракта
+ Спец символы в JSON полях
+ Проверка контейнера с двумя подписями
+ Раскраска контрактов
+ ЭЦП на сайте (подписание) заказчиками
+ ЭЦП на сайте (подписание) нами
+ Добавить статус Заявления архив. Ставится руками, запрещает любые исходящие письма заявителя
+ Время на хостинге +3?
+ Заполнение заявления: Типа добавил исполнителя, а при удалении - ошибка
+ Загрузка файла с кривым именем: EOL(13,10): так такой проблемы. файлы распознаются как разные bad(13)name.pdf и bad(13)name.pdf.sig
+ Сделать правильную работу ГУИ при подписании, загрузке. Отметка об удачной загрузке только после подписания.
+ Приходят значения client_type="on" в каких то случаях из IE возможно 8

				





